<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="payslip_template">
            <NominaIndividual xmlns:xs="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
                xmlns:ext="urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2"
                xmlns:xades="http://uri.etsi.org/01903/v1.3.2#" xmlns:xades141="http://uri.etsi.org/01903/v1.4.1#"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <ext:UBLExtensions>
                    <ext:UBLExtension>
                        <ext:ExtensionContent />
                    </ext:UBLExtension>
                </ext:UBLExtensions> 
                <Novedad>false</Novedad>
                <Periodo t-att-FechaIngreso='record.contract_id.date_start'
                    t-att-FechaLiquidacionInicio='record.date_from' t-att-FechaLiquidacionFin='record.date_to'
                    t-att-TiempoLaborado="record._get_work_time()" t-att-FechaGen="gen_date" />
                <NumeroSecuenciaXML t-att-Consecutivo="record._get_consecutivo()" t-att-Prefijo="record._get_Prefijo()"
                    t-att-Numero="record._get_numero()" />
                <LugarGeneracionXML t-att-Pais="record.company_id.country_id.code"
                    t-att-DepartamentoEstado="record.company_id.state_id.l10n_co_edi_code"
                    t-att-MunicipioCiudad="record.company_id.partner_id.xcity.code" Idioma="es" />
                <ProveedorXML t-att-NIT="record.company_id.partner_id.xidentification"
                    t-att-DV="record.company_id.partner_id.dv"
                    t-att-SoftwareID="record.company_id.software_identification_code"
                    t-att-SoftwareSC="record._generate_software_security_code()" />
                <CodigoQR>
                    <t t-esc="record._get_QRCode(gen_date, gen_hours)" />
                </CodigoQR>
                <InformacionGeneral Version="V1.0: Documento Soporte de Pago de NÃ³mina ElectrÃ³nica"
                    t-attf-Ambiente="{{ record.company_id.production and '1' or '2'}}"
                    t-att-TipoXML="record._get_tipo_xml()" t-att-CUNE="record._generate_CUNE(gen_date, gen_hours)"
                    EncripCUNE="CUNE-SHA384" t-att-FechaGen="gen_date" t-att-HoraGen="gen_hours"
                    t-att-PeriodoNomina="record._get_periodo_nomina()" t-att-TipoMoneda="record._get_currency()"
                    TRM="1" />
                <Empleador t-att-NIT="record.company_id.partner_id.xidentification"
                    t-att-DV="record.company_id.partner_id.dv" t-att-Pais="record.company_id.country_id.code"
                    t-att-DepartamentoEstado="record.company_id.state_id.l10n_co_edi_code"
                    t-att-MunicipioCiudad="record.company_id.partner_id.xcity.code"
                    t-att-Direccion="record.company_id.street" />
                <Trabajador t-att-TipoTrabajador="record.employee_id.employee_type"
                    t-att-SubTipoTrabajador="record.employee_id.employee_subtype"
                    t-att-AltoRiesgoPension="record.employee_id.high_risk and 'true' or 'false'"
                    t-att-TipoDocumento="record.employee_id.document_type"
                    t-att-NumeroDocumento="record.employee_id.id_document_payroll"
                    t-att-PrimerApellido="record.employee_id.second_namem"
                    t-att-SegundoApellido="record.employee_id.second_namef"
                    t-att-PrimerNombre="record.employee_id.first_name"
                    t-att-OtrosNombres="record.employee_id.first_name"
                    t-att-LugarTrabajoPais="record.employee_id.address_id.country_id.code"
                    t-att-LugarTrabajoDepartamentoEstado="record.employee_id.address_id.state_id.code"
                    t-att-LugarTrabajoMunicipioCiudad="record.employee_id.address_id.xcity.code"
                    t-att-LugarTrabajoDireccion="record.employee_id.address_id.street"
                    t-att-SalarioIntegral="record.it_is_integral and 'true' or 'false'"
                    t-att-TipoContrato="record.contract_id.contract_type" t-att-Sueldo="record.contract_id.wage"
                    t-att-CodigoTrabajador="record.employee_id.id" />
                <Pago Forma="1" t-att-Metodo="record._get_metodo()" />
                <FechasPagos>
                    <FechaPago>
                        <t t-esc="record._get_date_gen()" />
                    </FechaPago>
                </FechasPagos>
                <Devengados>
                    <t t-foreach="record.worked_days_line_ids" t-as="wline">
                        <Basico t-att-DiasTrabajados="int(wline.number_of_days)" t-att-SueldoTrabajado="record.contract_id.wage" />
                    </t>
                    <t t-foreach="record.line_ids.filtered(lambda l: l.salary_rule_id.rule_type == 'devengos')" t-as="line_values">
                        <t t-if="line_values.code == '1305'">
                            <Transporte t-att-AuxilioTransporte="line_values.total" />
                        </t>
                    </t>
                </Devengados>
                <Deducciones>
                    <t t-foreach="record.line_ids.filtered(lambda l: l.salary_rule_id.rule_type == 'deducciones')"
                        t-as="line_values">
                        <t t-if="line_values.code == '2150'">
                            <Salud t-att-Porcentaje="int(line_values.rate)" t-att-Deduccion="line_values.total" />
                        </t>
                        <t t-if="line_values.code == '2140'">
                            <FondoPension t-att-Porcentaje="int(line_values.rate)" t-att-Deduccion="line_values.total" />
                        </t>
                        <t t-if="line_values.code == '2142'">
                            <DevengadosTotal t-att-Porcentaje="int(line_values.rate)" t-att-Deduccion="line_values.total" />
                        </t>
                        <t t-if="line_values.code == '2141'">
                            <DeduccionesTotal t-att-Porcentaje="int(line_values.rate)" t-att-Deduccion="line_values.total" />
                        </t>
                        <t t-if="line_values.code == '02145'">
                            <ComprobanteTotal t-att-Porcentaje="int(line_values.rate)" t-att-Deduccion="line_values.total" />
                        </t>
                    </t>
                </Deducciones>
                <Redondeo>0.00</Redondeo>
                <DevengadosTotal>
                    <t t-esc="record._devengados_second_decimal()" />
                </DevengadosTotal>
                <DeduccionesTotal>
                    <t t-esc="record._deducciones_second_decimal()" />
                </DeduccionesTotal>
                <ComprobanteTotal>
                    <t t-esc="record._complements_second_decimal((record.contract_id.wage - record._get_deducciones()))" />
                </ComprobanteTotal>
            </NominaIndividual>
        </template>
    </data>
</odoo>